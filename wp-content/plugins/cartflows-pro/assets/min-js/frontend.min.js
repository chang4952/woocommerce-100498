!function(s){s(document).ready(function(r){r("body").on("wcf-show-loader",function(e){r(".wcf-loader-bg").addClass("show")}),r("body").on("wcf-hide-loader",function(e){r(".wcf-loader-bg").removeClass("show")}),r("body").on("wcf-update-msg",function(e,f,o){r(".wcf-order-msg .wcf-process-msg").text(f).addClass(o)}),s('a[href*="wcf-up-offer"], a[href*="wcf-down-offer"]').each(function(e){var f=s(this),o=f.attr("href");-1!==o.indexOf("wcf-up-offer-yes")&&f.attr("id","wcf-upsell-offer"),-1!==o.indexOf("wcf-down-offer-yes")&&f.attr("id","wcf-downsell-offer")}),s(document).on("click",'a[href*="wcf-up-offer"], a[href*="wcf-down-offer"]',function(e){e.preventDefault();var f=s(this).attr("href"),o="yes",r="upsell",t=cartflows_offer.step_id,a=cartflows_offer.product_id,c=cartflows_offer.order_id,d=cartflows_offer.order_key;if(-1!==f.indexOf("wcf-up-offer")&&(r="upsell",o=-1!==f.indexOf("wcf-up-offer-yes")?"yes":"no"),-1!==f.indexOf("wcf-down-offer")&&(r="downsell",o=-1!==f.indexOf("wcf-down-offer-yes")?"yes":"no"),"yes"!==cartflows_offer.skip_offer||"yes"!==o)return s("body").trigger("wcf-show-loader"),action="yes"===o?"wcf_"+r+"_accepted":"wcf_"+r+"_rejected",s.ajax({url:cartflows.ajax_url,data:{action:action,offer_action:o,step_id:t,product_id:a,order_id:c,order_key:d},dataType:"json",type:"POST",success:function(e){var f=e.message,o="wcf-payment-"+e.status;s("body").trigger("wcf-update-msg",[f,o]),setTimeout(function(){window.location.href=e.redirect},500)}}),!1}),s(document).on("click",".wcf-upsell-offer, .wcf-downsell-offer",function(e){e.preventDefault();var f=s(this),o=f.data("action"),r="upsell",t=f.data("step"),a=f.data("product"),c=f.data("order"),d=f.data("order_key");if(!f.hasClass("cartflows-skip")||"yes"!==o)return s("body").trigger("wcf-show-loader"),f.hasClass("wcf-downsell-offer")&&(r="downsell"),action="yes"===o?"wcf_"+r+"_accepted":"wcf_"+r+"_rejected",s.ajax({url:cartflows.ajax_url,data:{action:action,offer_action:o,step_id:t,product_id:a,order_id:c,order_key:d},dataType:"json",type:"POST",success:function(e){var f=e.message,o="wcf-payment-"+e.status;s("body").trigger("wcf-update-msg",[f,o]),setTimeout(function(){window.location.href=e.redirect},500)}}),!1})})}(jQuery);